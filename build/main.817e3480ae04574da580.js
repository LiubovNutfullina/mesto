(()=>{"use strict";function e(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",n)}function t(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",n)}function n(e){"Escape"===e.key&&t(document.querySelector(".popup_is-opened"))}class i{constructor(e,t,n){this._name=e,this._link=t,this._templateSelector=n}generateCard(){return this._newCard=this._getTemplate(),this._inputData(),this._setEventListeners(),this._newCard}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_deleteCard(){this._newCard.remove(),this._newCard=null}_likeCard(){this._newCard.querySelector(".element__like").classList.toggle("element__like_active")}_openImagePopup(){const t=document.querySelector(".popup__image");t.setAttribute("src",this._link),t.setAttribute("alt","Здесь показано место "+this._name);const n=document.querySelector(".popup__title-image"),i=document.querySelector(".element__title");n.textContent=i.textContent,e(document.querySelector(".popup_image"))}_setEventListeners(){this._newCard.querySelector(".element__trash").addEventListener("click",(()=>{this._deleteCard()})),this._newCard.querySelector(".element__like").addEventListener("click",(()=>{this._likeCard()})),this._newCard.querySelector(".element__image").addEventListener("click",(()=>{this._openImagePopup()}))}_inputData(){this._newCard.querySelector(".element__title").textContent=this._name;const e=this._newCard.querySelector(".element__image");e.src=this._link,e.setAttribute("alt","Здесь показано место "+this._name)}}class o{constructor(e,t){this._validationConfig=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._validationConfig.inputSelector)),this._buttonElement=this._formElement.querySelector(this._validationConfig.submitButtonSelector)}enableValidation(){this._setEventListeners()}removeValidationErrors(){Array.from(this._formElement.querySelectorAll(this._validationConfig.inputErrorSelector)).forEach((e=>{e.textContent=""})),this._inputList.forEach((e=>{e.classList.remove(this._validationConfig.inputTextInvalidClass)}))}enableSubmitButton(){this._buttonElement.classList.remove(this._validationConfig.inactiveButtonClass),this._buttonElement.disabled=!1}disableSubmitButton(){this._buttonElement.classList.add(this._validationConfig.inactiveButtonClass),this._buttonElement.disabled=!0}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._isValid(e),this._toggleButtonState()}))}))}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():this.enableSubmitButton()}_isValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._validationConfig.inputTextInvalidClass),t.textContent=e.validationMessage}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._validationConfig.inputTextInvalidClass),t.textContent=""}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}}const r=document.querySelector(".elements"),s=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=document.querySelector(".profile__title"),u=document.querySelector(".profile__subtitle"),d=document.querySelector(".popup_edit"),c=document.querySelector(".popup_add"),_=document.querySelector(".popup_image"),p=document.querySelector(".popup__close_edit"),m=document.querySelector(".popup__close_add"),h=document.querySelector(".popup__close_image"),v=document.querySelector(".popup__content_edit"),y=document.querySelector(".popup__content_add"),S=document.querySelector(".input__text_type_name"),E=document.querySelector(".input__text_type_job"),f=document.querySelector(".input__text_type_title"),C=document.querySelector(".input__text_type_link"),g=c.querySelector(".popup__content_form"),b=d.querySelector(".popup__content_form"),q={inputSelector:".input__text",submitButtonSelector:".input__button-submit",inputTextInvalidClass:"input__text_invalid",inactiveButtonClass:"input__button-submit_invalid",inputErrorSelector:".input__text-error"},k=new o(q,g),L=new o(q,b);function x(e){e.target===e.currentTarget&&t(e.target)}k.enableValidation(),L.enableValidation(),p.addEventListener("click",(()=>t(d))),m.addEventListener("click",(()=>t(c))),h.addEventListener("click",(()=>t(_))),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){const t=new i(e.name,e.link,"#element-template");r.append(t.generateCard())})),s.addEventListener("click",(function(){S.value=a.textContent,E.value=u.textContent,L.removeValidationErrors(),L.enableSubmitButton(),e(d)})),l.addEventListener("click",(function(){f.value="",C.value="",k.removeValidationErrors(),k.disableSubmitButton(),e(c)})),v.addEventListener("submit",(function(e){e.preventDefault(),a.textContent=S.value,u.textContent=E.value,t(d)})),y.addEventListener("submit",(function(e){e.preventDefault();const n=new i(f.value,C.value,"#element-template");r.prepend(n.generateCard()),t(c)})),d.addEventListener("mousedown",x),c.addEventListener("mousedown",x),_.addEventListener("mousedown",x)})();